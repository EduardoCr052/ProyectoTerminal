\usepackage[hidelinks]{hyperref}
\usepackage[letterpaper, margin=1in]{geometry} % 'nohead' eliminado para compatibilidad con fancyhdr
\usepackage{array} % Coma inicial corregida
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{pgfgantt}
\usepackage{soul}
\usepackage[bottom]{footmisc}
\usepackage{titlesec}
\titleformat*{\section}{\large\bfseries}
\titleformat*{\subsection}{\normalsize\bfseries}
\usepackage{palatino}
\usepackage{caption}
\usepackage{subcaption}
\captionsetup[figure]{name={Figura },labelsep=period}
\captionsetup[table]{name={Tabla },labelsep=period}
\usepackage[spanish]{babel}
\usepackage{imakeidx}
\makeindex[columns=3, title=Alphabetical Index, intoc]
\usepackage{float}
\usepackage{amsmath}
\usepackage{comment}
\usepackage{listings}
\usepackage[dvipsnames]{xcolor} % Movido aquí para estar disponible para todos los paquetes
\usepackage{tabularx}

% --- PAQUETES EXTRAÍDOS DE 'electronica.cls' ---

% AGREGADO: Para tablas que pueden ocupar varias páginas.
\usepackage{longtable}

% AGREGADO: Mejor control sobre la alineación de texto (izquierda, derecha, justificado).
\usepackage{ragged2e}

% AGREGADO: Herramientas de programación para LaTeX, necesarias para comandos condicionales.
\usepackage{etoolbox}
\usepackage{ifthen}

% AGREGADO: Mayor control sobre el formato de las listas (enumerate, itemize).
\usepackage{enumitem}

% AGREGADO: Codificación de fuentes correcta para visualización en PDF y manejo de caracteres.
\usepackage[T1]{fontenc}

% AGREGADO: Para personalizar los encabezados y pies de página.
\usepackage{fancyhdr}


% AGREGADO: Configuración de encabezados y pies de página como en la plantilla del profesor.
\fancyhead{} % Limpia los campos del encabezado
\fancyhead[L]{\footnotesize Propuesta de Proyecto de Integración}
\fancyhead[R]{\footnotesize Ingeniería en Electrónica}
\fancyfoot[R]{\footnotesize \thepage}
\fancyfoot[L]{\footnotesize UAM-Azcapotzalco}
\fancyfoot[C]{}

% AGREGADO: Define la ruta donde buscará las imágenes por defecto.
\graphicspath{{./Imagenes/}}

% AGREGADO: Definiciones de colores y estilo para el código fuente (paquete 'listings').
\definecolor{verde}{rgb}{0,0.6,0}
\definecolor{gris}{rgb}{0.5,0.5,0.5}
\definecolor{mageta}{rgb}{0.58,0,0.82}
\definecolor{negro}{rgb}{0.95,0.95,0.92}


\lstset{ 
  backgroundcolor=\color{white},   % Indica el color de fondo; necesita que se añada \usepackage{color} o \usepackage{xcolor}
  basicstyle=\footnotesize,        % Fija el tamaño del tipo de letra utilizado para el código
  breakatwhitespace=false,         % Activarlo para que los saltos automáticos solo se apliquen en los espacios en blanco
  breaklines=true,                 % Activa el salto de línea automático
  captionpos=b,                    % Establece la posición de la leyenda del cuadro de código
  commentstyle=\color{verde},    % Estilo de los comentarios
  deletekeywords={...},            % Si se quiere eliminar palabras clave del lenguaje
  extendedchars=true,              % Permite utilizar caracteres extendidos no-ASCII; solo funciona para codificaciones de 8-bits; para UTF-8 no funciona. En xelatex necesita estar a true para que funcione.
  frame=single,	                   % Añade un marco al código
  keepspaces=true,                 % Mantiene los espacios en el texto. Es útil para mantener la indentación del código(puede necesitar columns=flexible).
  keywordstyle=\color{blue},       % estilo de las palabras clave
  otherkeywords={*,...},           % Si se quieren añadir otras palabras clave al lenguaje
  numbers=left,                    % Posición de los números de línea (none, left, right).
  numbersep=8pt,                   % Distancia de los números de línea al código
  numberstyle=\tiny\color{gris}, % Estilo para los números de línea
  rulecolor=\color{black},         % Si no se activa, el color del marco puede cambiar en los saltos de línea entre textos que sea de otro color, por ejemplo, los comentarios, que están en verde en este ejemplo
  showspaces=false,                % Si se activa, muestra los espacios con guiones bajos; sustituye a 'showstringspaces'
  showstringspaces=false,          % subraya solamente los espacios que estén en una cadena de esto
  showtabs=false,                  % muestra las tabulaciones que existan en cadenas de texto con guión bajo
  stepnumber=1,                    % Muestra solamente los números de línea que corresponden a cada salto. En este caso: 1,3,5,...
  stringstyle=\color{mageta},     % Estilo de las cadenas de texto
  tabsize=4,	                   % Establece el salto de las tabulaciones a 2 espacios
  title=\lstname                   % muestra el nombre de los ficheros incluidos al utilizar \lstinputlisting; también se puede utilizar en el parámetro caption
}

\lstset{literate=
  {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
  {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
  {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
  {À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
  {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
  {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
  {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
  {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
  {ã}{{\~a}}1 {ẽ}{{\~e}}1 {ĩ}{{\~i}}1 {õ}{{\~o}}1 {ũ}{{\~u}}1
  {Ã}{{\~A}}1 {Ẽ}{{\~E}}1 {Ĩ}{{\~I}}1 {Õ}{{\~O}}1 {Ũ}{{\~U}}1
  {’}{{\''}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
  {ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1
  {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
  {€}{{\euro}}1 {£}{{\pounds}}1 {«}{{\guillemotleft}}1
  {»}{{\guillemotright}}1 {ñ}{{\~n}}1 {Ñ}{{\~N}}1 {¿}{{?`}}1 {¡}{{!`}}1 
}

\renewcommand{\lstlistingname}{Código}
\renewcommand{\lstlistlistingname}{Lista de \lstlistingname s}
%\renewcommand{\theenumi}{\alph{enumi}}  % Cambia la numeración de los items de las listas a, b, c, ...


\lstdefinestyle{mystyle}{
    backgroundcolor=\color{negro},
    commentstyle=\color{verde},
    keywordstyle=\color{mageta},
    numberstyle=\tiny\color{gris},
    stringstyle=\color{magenta},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle} % Aplica el estilo definido